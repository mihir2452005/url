<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>URL Detection System - Scoring Reference</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }
        h2 {
            color: #34495e;
            background-color: #ecf0f1;
            padding: 10px;
            border-left: 4px solid #3498db;
        }
        h3 {
            color: #2980b9;
            margin-top: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 15px 0;
        }
        th, td {
            border: 1px solid #bdc3c7;
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #3498db;
            color: white;
        }
        tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        .layer1 { background-color: #ffebee; }
        .layer2 { background-color: #e8f5e8; }
        .layer3 { background-color: #e3f2fd; }
        .ssl { background-color: #fff3e0; }
        .other { background-color: #f3e5f5; }
        .thresholds {
            background-color: #fff8e1;
            padding: 15px;
            border-radius: 5px;
            border-left: 4px solid #ffc107;
        }
        .risk-high { color: #c0392b; font-weight: bold; }
        .risk-medium { color: #d35400; font-weight: bold; }
        .risk-low { color: #27ae60; font-weight: bold; }
        .section {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
        }
        .legend {
            display: flex;
            justify-content: space-around;
            flex-wrap: wrap;
            margin: 20px 0;
            padding: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin: 5px 10px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            margin-right: 5px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>URL Detection System - Scoring Reference</h1>
        <p>This document provides a comprehensive overview of all risk parameters and their corresponding numerical scores used in the URL detection system.</p>
        
        <div class="section">
            <h2>Parameter Counts by Risk Level</h2>
            <div style="display: flex; flex-wrap: wrap; gap: 20px; margin-bottom: 20px;">
                <div style="flex: 1; min-width: 200px; padding: 15px; background-color: #ffebee; border-radius: 5px;">
                    <h3 style="color: #c0392b; margin-top: 0;">High Risk (60+)</h3>
                    <ul style="padding-left: 20px;">
                        <li><strong>90+ scores:</strong> 3 parameters</li>
                        <li><strong>80-89 scores:</strong> 7 parameters</li>
                        <li><strong>70-79 scores:</strong> 14 parameters</li>
                        <li><strong>60-69 scores:</strong> 15 parameters</li>
                        <li><strong>Total High Risk:</strong> 39 parameters</li>
                    </ul>
                </div>
                <div style="flex: 1; min-width: 200px; padding: 15px; background-color: #fef9e7; border-radius: 5px;">
                    <h3 style="color: #d35400; margin-top: 0;">Medium Risk (30-59)</h3>
                    <ul style="padding-left: 20px;">
                        <li><strong>50-59 scores:</strong> 10 parameters</li>
                        <li><strong>40-49 scores:</strong> 11 parameters</li>
                        <li><strong>30-39 scores:</strong> 8 parameters</li>
                        <li><strong>Total Medium Risk:</strong> 29 parameters</li>
                    </ul>
                </div>
                <div style="flex: 1; min-width: 200px; padding: 15px; background-color: #e8f6f3; border-radius: 5px;">
                    <h3 style="color: #27ae60; margin-top: 0;">Low Risk (1-29)</h3>
                    <ul style="padding-left: 20px;">
                        <li><strong>20-29 scores:</strong> 6 parameters</li>
                        <li><strong>10-19 scores:</strong> 11 parameters</li>
                        <li><strong>1-9 scores:</strong> 4 parameters</li>
                        <li><strong>Total Low Risk:</strong> 21 parameters</li>
                    </ul>
                </div>
            </div>
            <p><strong>Total Parameters Tracked:</strong> 89 parameters across all risk levels</p>
        </div>
        
        <div class="legend">
            <div class="legend-item"><div class="legend-color" style="background-color: #ffebee;"></div> Layer 1: Static Analysis</div>
            <div class="legend-item"><div class="legend-color" style="background-color: #e8f5e8;"></div> Layer 2: Reputation Analysis</div>
            <div class="legend-item"><div class="legend-color" style="background-color: #e3f2fd;"></div> Layer 3: Content Analysis</div>
            <div class="legend-item"><div class="legend-color" style="background-color: #fff3e0;"></div> SSL/TLS Analysis</div>
            <div class="legend-item"><div class="legend-color" style="background-color: #f3e5f5;"></div> Other Components</div>
        </div>

        <div class="section thresholds">
            <h2>Classification Thresholds</h2>
            <table>
                <tr>
                    <th>Classification</th>
                    <th>Score Range</th>
                    <th>Description</th>
                </tr>
                <tr>
                    <td><span class="risk-low">Safe</span></td>
                    <td>0 - 29</td>
                    <td>Legitimate, low-risk URLs</td>
                </tr>
                <tr>
                    <td><span class="risk-medium">Suspicious</span></td>
                    <td>30 - 59</td>
                    <td>Potentially risky URLs requiring closer inspection</td>
                </tr>
                <tr>
                    <td><span class="risk-high">Malicious</span></td>
                    <td>60+</td>
                    <td>High-risk URLs likely to be harmful</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>Layer 1: Static Analysis (Syntax Check)</h2>
            <p>Instant rejection of obviously bad URLs using local string analysis without internet access.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="layer1">
                    <td>Invalid URL</td>
                    <td class="risk-high">90</td>
                    <td>No hostname found in URL</td>
                </tr>
                <tr class="layer1">
                    <td>IP Address in URL</td>
                    <td class="risk-high">80</td>
                    <td>URL uses IP address instead of domain (e.g., http://192.168.1.5)</td>
                </tr>
                <tr class="layer1">
                    <td>Double Extension</td>
                    <td class="risk-high">85</td>
                    <td>Suspicious double extensions (e.g., document.pdf.exe)</td>
                </tr>
                <tr class="layer1">
                    <td>High Entropy Domain</td>
                    <td class="risk-medium">60</td>
                    <td>Random character patterns in domain (entropy > 4.0)</td>
                </tr>
                <tr class="layer1">
                    <td>Keyword Stuffing</td>
                    <td class="risk-medium">50</td>
                    <td>Multiple suspicious keywords (secure, login, update, password, etc.)</td>
                </tr>
                <tr class="layer1">
                    <td>Character Repetition</td>
                    <td class="risk-medium">45</td>
                    <td>Excessive character repetition (e.g., aaaa.com)</td>
                </tr>
                <tr class="layer1">
                    <td>Excessive Hyphens</td>
                    <td class="risk-medium">40</td>
                    <td>More than 4 hyphens in domain name</td>
                </tr>
                <tr class="layer1">
                    <td>Homograph Risk</td>
                    <td class="risk-high">70</td>
                    <td>Confusable characters detected (e.g., Cyrillic vs Latin)</td>
                </tr>
                <tr class="layer1">
                    <td>Punycode/IDN</td>
                    <td class="risk-high">55</td>
                    <td>Uses Punycode (xn--) which can hide non-Latin characters</td>
                </tr>
                <tr class="layer1">
                    <td>Long URL</td>
                    <td class="risk-medium">25</td>
                    <td>URL is over 100 characters, somewhat suspicious</td>
                </tr>
                <tr class="layer1">
                    <td>Excessive Length</td>
                    <td class="risk-high">45-95</td>
                    <td>URL is over 150 chars (45 base + up to 50 extra), often used to hide malicious content</td>
                </tr>
                <tr class="layer1">
                    <td>Obfuscated Authority</td>
                    <td class="risk-high">75</td>
                    <td>Uses "@" in domain to hide actual host</td>
                </tr>
                <tr class="layer1">
                    <td>High-Risk TLD</td>
                    <td class="risk-high">55</td>
                    <td>TLD is frequently abused (free domain service)</td>
                </tr>
                <tr class="layer1">
                    <td>Executable Download</td>
                    <td class="risk-high">65</td>
                    <td>Direct link to executable file</td>
                </tr>
                <tr class="layer1">
                    <td>Archive Download</td>
                    <td class="risk-medium">30</td>
                    <td>Direct link to archive file</td>
                </tr>
                <tr class="layer1">
                    <td>Remote Access Port</td>
                    <td class="risk-high">45</td>
                    <td>Uses remote access port (22, 23, 3389)</td>
                </tr>
                <tr class="layer1">
                    <td>Open Redirect Risk</td>
                    <td class="risk-medium">40</td>
                    <td>Query contains redirect to external URL</td>
                </tr>
                <tr class="layer1">
                    <td>Character Repetition</td>
                    <td class="risk-medium">30</td>
                    <td>Unusually repeated special characters</td>
                </tr>
                <tr class="layer1">
                    <td>Mixed TLD Pattern</td>
                    <td class="risk-high">65</td>
                    <td>Suspicious TLD combination (e.g., .com.tk)</td>
                </tr>
                <tr class="layer1">
                    <td>Many Subdomains</td>
                    <td class="risk-medium">20</td>
                    <td>More than 4 subdomain levels</td>
                </tr>
                <tr class="layer1">
                    <td>High Hex Encoding</td>
                    <td class="risk-medium">35</td>
                    <td>High percentage of hex-encoded characters</td>
                </tr>
                <tr class="layer1">
                    <td>Long Digit Sequences</td>
                    <td class="risk-medium">35</td>
                    <td>Sequences of 4+ consecutive digits</td>
                </tr>
                <tr class="layer1">
                    <td>Advanced Homograph Attack</td>
                    <td class="risk-high">70</td>
                    <td>Mixed scripts detected (e.g., Cyrillic + Latin)</td>
                </tr>
                <tr class="layer1">
                    <td>Excessive Subdomains</td>
                    <td class="risk-medium">20</td>
                    <td>More than 4 subdomain levels</td>
                </tr>
                <tr class="layer1">
                    <td>Public IP Address URL</td>
                    <td class="risk-high">70</td>
                    <td>URL uses raw public IP address instead of domain</td>
                </tr>
                <tr class="layer1">
                    <td>Private IP Address</td>
                    <td class="risk-medium">15</td>
                    <td>Uses private/localhost IP (dev/testing environment)</td>
                </tr>
                <tr class="layer1">
                    <td>Double Slash in Path</td>
                    <td class="risk-medium">Variable (0-40)</td>
                    <td>Contains "//" in path, may indicate open redirect</td>
                </tr>
                <tr class="layer1">
                    <td>Keyword Variation</td>
                    <td class="risk-medium">Variable (0-15)</td>
                    <td>Suspicious keyword variation (keyword with digit)</td>
                </tr>
                <tr class="layer1">
                    <td>Leetspeak Typosquatting</td>
                    <td class="risk-high">Variable (0-45)</td>
                    <td>Detected leetspeak in domain (e.g., l0gin instead of login)</td>
                </tr>
                <tr class="layer1">
                    <td>High Hex Encoding</td>
                    <td class="risk-high">50</td>
                    <td>Heavy use of % encoding to bypass filters (>30% of URL)</td>
                </tr>
                <tr class="layer1">
                    <td>Moderate Hex Encoding</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Notable % encoding (>20% of URL)</td>
                </tr>
                <tr class="layer1">
                    <td>Very High Entropy</td>
                    <td class="risk-high">60</td>
                    <td>Domain has very random appearance (entropy: >4.8)</td>
                </tr>
                <tr class="layer1">
                    <td>High Entropy</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Domain appears random (entropy: >4.5)</td>
                </tr>
                <tr class="layer1">
                    <td>Homograph Attack</td>
                    <td class="risk-high">70</td>
                    <td>Mixes character scripts to spoof domains</td>
                </tr>
                <tr class="layer1">
                    <td>Suspicious TLD</td>
                    <td class="risk-medium">Variable (0-30)</td>
                    <td>TLD has elevated abuse rates</td>
                </tr>
                <tr class="layer1">
                    <td>Archive Download</td>
                    <td class="risk-medium">Variable (0-30)</td>
                    <td>Direct link to archive file</td>
                </tr>
                <tr class="layer1">
                    <td>Non-Standard Port</td>
                    <td class="risk-medium">Variable (0-40)</td>
                    <td>Uses unusual port</td>
                </tr>
                <tr class="layer1">
                    <td>URL Shortener</td>
                    <td class="risk-high">50</td>
                    <td>Uses URL shortener to hide destination</td>
                </tr>
                <tr class="layer1">
                    <td>Redirect Parameter</td>
                    <td class="risk-medium">Variable (0-20)</td>
                    <td>Query has redirect parameter</td>
                </tr>
                <tr class="layer1">
                    <td>Dangerous Double Extension</td>
                    <td class="risk-high">95</td>
                    <td>Dangerous double file extension detected (e.g., .exe.pdf)</td>
                </tr>
                <tr class="layer1">
                    <td>Very High Entropy</td>
                    <td class="risk-high">40-90</td>
                    <td>Very high randomness in URL path/query (entropy > 4.5)</td>
                </tr>
                <tr class="layer1">
                    <td>Keyword Stuffing</td>
                    <td class="risk-high">80</td>
                    <td>Keyword stuffing detected with 3+ unique security keywords</td>
                </tr>
                <tr class="layer1">
                    <td>Very High Encoding</td>
                    <td class="risk-high">80</td>
                    <td>Very high percent encoding (>25% of URL)</td>
                </tr>
                <tr class="layer1">
                    <td>High Encoding</td>
                    <td class="risk-high">60</td>
                    <td>High percent encoding (>15% of URL)</td>
                </tr>
                <tr class="layer1">
                    <td>Excessive Subdomains</td>
                    <td class="risk-high">70</td>
                    <td>Excessive subdomains (>5 parts)</td>
                </tr>
                <tr class="layer1">
                    <td>Very Long URL</td>
                    <td class="risk-medium">60</td>
                    <td>Very long URL (>4000 characters)</td>
                </tr>
                <tr class="layer1">
                    <td>Homograph Attack</td>
                    <td class="risk-high">90</td>
                    <td>Potential homograph attack characters detected</td>
                </tr>
                <tr class="layer1">
                    <td>Character Repetition</td>
                    <td class="risk-high">70</td>
                    <td>Excessive character repetition (6+ consecutive identical chars)</td>
                </tr>
                <tr class="layer1">
                    <td>Sequential Digits</td>
                    <td class="risk-medium">45</td>
                    <td>Consecutive digits in domain (4+ digits)</td>
                </tr>
                <tr class="layer1">
                    <td>Mixed TLD Pattern</td>
                    <td class="risk-high">75</td>
                    <td>Suspicious TLD combination mixing legitimate and suspicious TLDs</td>
                </tr>
                <tr class="layer1">
                    <td>Obfuscated Authority</td>
                    <td class="risk-high">85</td>
                    <td>Uses "@" in domain to hide actual host - credential harvesting</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>Layer 2: Reputation Analysis (History Check)</h2>
            <p>Queries trusted external databases (VirusTotal, Google Safe Browsing) to identify known malicious sites.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="layer2">
                    <td>Known Bad Pattern</td>
                    <td class="risk-high">90</td>
                    <td>URL contains known malicious patterns (phishing, malware, scam, etc.)</td>
                </tr>
                <tr class="layer2">
                    <td>Content Fetch Error</td>
                    <td class="risk-low">20</td>
                    <td>Could not fetch content due to network issues</td>
                </tr>
                <tr class="layer2">
                    <td>ML Confidence (%)</td>
                    <td class="risk-medium">N/A</td>
                    <td>Machine learning model confidence level (0-100%)</td>
                </tr>
                <tr class="layer2">
                    <td>ML Score</td>
                    <td class="risk-medium">0-100</td>
                    <td>Machine learning model risk score</td>
                </tr>
                <tr class="layer2">
                    <td>ML Prediction</td>
                    <td class="risk-medium">N/A</td>
                    <td>Machine learning model prediction (Benign, Suspicious, Malicious)</td>
                </tr>
                <tr class="layer2">
                    <td>Feature Count</td>
                    <td class="risk-medium">45</td>
                    <td>Number of features extracted for ML analysis (45 features total)</td>
                </tr>
                <tr class="layer2">
                    <td>Enhanced Brand Detection</td>
                    <td class="risk-high">Variable</td>
                    <td>Brand impersonation detection in domain with 30+ major brands</td>
                </tr>
                <tr class="layer2">
                    <td>Extended TLD Analysis</td>
                    <td class="risk-medium">Variable</td>
                    <td>Detection of 20+ additional suspicious TLDs</td>
                </tr>
                <tr class="layer2">
                    <td>Homograph Feature</td>
                    <td class="risk-medium">Variable</td>
                    <td>Homograph detection included as ML feature</td>
                </tr>
                <tr class="layer2">
                    <td>Double Extension Feature</td>
                    <td class="risk-medium">Variable</td>
                    <td>Double extension detection included as ML feature</td>
                </tr>
                <tr class="layer2">
                    <td>Sequential Digit Feature</td>
                    <td class="risk-medium">Variable</td>
                    <td>Sequential digit detection in domain as ML feature</td>
                </tr>
                <tr class="layer2">
                    <td>Malicious Pattern Feature</td>
                    <td class="risk-medium">Variable</td>
                    <td>Regex-based pattern matching as ML feature</td>
                </tr>
                <tr class="layer2">
                    <td>Query Complexity Feature</td>
                    <td class="risk-medium">Variable</td>
                    <td>Query parameter complexity as ML feature</td>
                </tr>
                <tr class="layer2">
                    <td>Non-ASCII Character Feature</td>
                    <td class="risk-medium">Variable</td>
                    <td>Detection of non-ASCII characters as ML feature</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>Layer 3: RAG-Based Content Analysis (Intent Check)</h2>
            <p>Detects zero-day phishing by analyzing page content for brand impersonation and suspicious elements.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="layer3">
                    <td>Brand Impersonation</td>
                    <td class="risk-high">80</td>
                    <td>Brand name mentioned in content but not in domain</td>
                </tr>
                <tr class="layer3">
                    <td>External Login Form</td>
                    <td class="risk-high">75</td>
                    <td>Login form posts to external domain</td>
                </tr>
                <tr class="layer3">
                    <td>Hidden Iframes</td>
                    <td class="risk-high">65</td>
                    <td>Hidden iframes detected (potential drive-by downloads)</td>
                </tr>
                <tr class="layer3">
                    <td>Suspicious Script</td>
                    <td class="risk-medium">55</td>
                    <td>Suspicious JavaScript patterns detected</td>
                </tr>
                <tr class="layer3">
                    <td>Suspicious Login Action</td>
                    <td class="risk-medium">60</td>
                    <td>Login form action contains suspicious keywords</td>
                </tr>
                <tr class="layer3">
                    <td>Content Fetch Error</td>
                    <td class="risk-low">20</td>
                    <td>Could not fetch content due to network issues</td>
                </tr>
                <tr class="layer3">
                    <td>Content Analysis Error</td>
                    <td class="risk-low">10</td>
                    <td>Error in content analysis process</td>
                </tr>
                <tr class="layer3">
                    <td>Content Analysis Skipped</td>
                    <td class="risk-low">5</td>
                    <td>Required libraries (requests, bs4) not available</td>
                </tr>
                <tr class="layer3">
                    <td>External POST Form</td>
                    <td class="risk-high">60</td>
                    <td>Form POSTs credentials to external domain</td>
                </tr>
                <tr class="layer3">
                    <td>Suspicious Hidden Fields</td>
                    <td class="risk-medium">35</td>
                    <td>Hidden fields with sensitive names (password, token, session)</td>
                </tr>
                <tr class="layer3">
                    <td>Eval Chain Detected</td>
                    <td class="risk-high">60</td>
                    <td>Chained eval() calls indicating heavy obfuscation</td>
                </tr>
                <tr class="layer3">
                    <td>String Concatenation Obfuscation</td>
                    <td class="risk-high">45</td>
                    <td>Excessive string concatenations for obfuscation</td>
                </tr>
                <tr class="layer3">
                    <td>Multiple Redirect Mechanisms</td>
                    <td class="risk-high">50</td>
                    <td>Multiple different redirect methods detected</td>
                </tr>
                <tr class="layer3">
                    <td>Credential Handling in Script</td>
                    <td class="risk-high">55</td>
                    <td>Scripts handling credentials in suspicious ways</td>
                </tr>
                <tr class="layer3">
                    <td>Mixed Language Scripts</td>
                    <td class="risk-medium">35</td>
                    <td>Page uses multiple different writing systems</td>
                </tr>
                <tr class="layer3">
                    <td>Spelling Errors</td>
                    <td class="risk-medium">40</td>
                    <td>Common phishing misspellings detected</td>
                </tr>
                <tr class="layer3">
                    <td>Enhanced Brand Impersonation</td>
                    <td class="risk-high">75</td>
                    <td>Brand name mentioned multiple times in content but not in domain (40+ brands)</td>
                </tr>
                <tr class="layer3">
                    <td>Missing CSRF Token</td>
                    <td class="risk-high">60</td>
                    <td>Form lacks CSRF protection - potential credential harvesting</td>
                </tr>
                <tr class="layer3">
                    <td>Insecure Password Form</td>
                    <td class="risk-high">70</td>
                    <td>Password form submitted over unencrypted HTTP</td>
                </tr>
                <tr class="layer3">
                    <td>Urgent Action Required</td>
                    <td class="risk-high">65</td>
                    <td>Found multiple instances of urgent action language in content</td>
                </tr>
                <tr class="layer3">
                    <td>Account Verification Request</td>
                    <td class="risk-high">65</td>
                    <td>Multiple account verification requests detected in content</td>
                </tr>
                <tr class="layer3">
                    <td>Clickbait Language</td>
                    <td class="risk-medium">65</td>
                    <td>Found multiple instances of clickbait language in content</td>
                </tr>
                <tr class="layer3">
                    <td>Prize/Winning Scam</td>
                    <td class="risk-medium">65</td>
                    <td>Multiple prize or winning scam indicators in content</td>
                </tr>
                <tr class="layer3">
                    <td>Account Status Threat</td>
                    <td class="risk-medium">65</td>
                    <td>Multiple account status threat indicators in content</td>
                </tr>
                <tr class="layer3">
                    <td>Information Request</td>
                    <td class="risk-medium">65</td>
                    <td>Multiple information request indicators in content</td>
                </tr>
                <tr class="layer3">
                    <td>Banking Impersonation</td>
                    <td class="risk-medium">65</td>
                    <td>Multiple banking impersonation indicators in content</td>
                </tr>
                <tr class="layer3">
                    <td>Payment Related</td>
                    <td class="risk-medium">65</td>
                    <td>Multiple payment-related indicators in content</td>
                </tr>
                <tr class="layer3">
                    <td>Document Impersonation</td>
                    <td class="risk-medium">65</td>
                    <td>Multiple document impersonation indicators in content</td>
                </tr>
                <tr class="layer3">
                    <td>Suspicious External Links</td>
                    <td class="risk-high">70</td>
                    <td>Multiple suspicious external links found</td>
                </tr>
                <tr class="layer3">
                    <td>Dynamic URL Redirection</td>
                    <td class="risk-high">60</td>
                    <td>Found suspicious JavaScript patterns for dynamic redirection</td>
                </tr>
                <tr class="layer3">
                    <td>DOM Manipulation</td>
                    <td class="risk-medium">60</td>
                    <td>Found suspicious JavaScript patterns for DOM manipulation</td>
                </tr>
                <tr class="layer3">
                    <td>Code Evaluation</td>
                    <td class="risk-high">60</td>
                    <td>Found suspicious JavaScript patterns for code evaluation</td>
                </tr>
                <tr class="layer3">
                    <td>Encoding/Decoding</td>
                    <td class="risk-medium">60</td>
                    <td>Found suspicious JavaScript patterns for encoding/decoding</td>
                </tr>
                <tr class="layer3">
                    <td>Obfuscated Regex</td>
                    <td class="risk-medium">60</td>
                    <td>Found suspicious obfuscated regex patterns in JavaScript</td>
                </tr>
                <tr class="layer3">
                    <td>Character Manipulation</td>
                    <td class="risk-medium">60</td>
                    <td>Found suspicious character manipulation in JavaScript</td>
                </tr>
                <tr class="layer3">
                    <td>No Index Tag</td>
                    <td class="risk-medium">35</td>
                    <td>Site prevents search engine indexing</td>
                </tr>
                <tr class="layer3">
                    <td>Suspicious Brand Images</td>
                    <td class="risk-medium">50</td>
                    <td>Images with brand names but not in domain detected</td>
                </tr>
                <tr class="layer3">
                    <td>External iFrame</td>
                    <td class="risk-high">65</td>
                    <td>Embedded content from external domain detected</td>
                </tr>
                <tr class="layer3">
                    <td>Free Offer Lure</td>
                    <td class="risk-medium">55</td>
                    <td>Social engineering lure with free offer detected</td>
                </tr>
                <tr class="layer3">
                    <td>Scarcity Lure</td>
                    <td class="risk-medium">55</td>
                    <td>Social engineering lure with scarcity detected</td>
                </tr>
                <tr class="layer3">
                    <td>Clickbait Lure</td>
                    <td class="risk-medium">55</td>
                    <td>Social engineering lure with clickbait detected</td>
                </tr>
                <tr class="layer3">
                    <td>Urgency Lure</td>
                    <td class="risk-medium">55</td>
                    <td>Social engineering lure with urgency detected</td>
                </tr>
                <tr class="layer3">
                    <td>Threat Lure</td>
                    <td class="risk-medium">55</td>
                    <td>Social engineering lure with threats detected</td>
                </tr>
                <tr class="layer3">
                    <td>Fake Security Claim</td>
                    <td class="risk-medium">50</td>
                    <td>Claims security features but uses HTTP, not HTTPS</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>SSL/TLS Analysis</h2>
            <p>Certificate validation and protocol security checks.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="ssl">
                    <td>Invalid Host</td>
                    <td class="risk-low">10</td>
                    <td>Invalid hostname or parsing error</td>
                </tr>
                <tr class="ssl">
                    <td>Invalid Host Format</td>
                    <td class="risk-low">10</td>
                    <td>Hostname format doesn't comply with RFC standards</td>
                </tr>
                <tr class="ssl">
                    <td>No HTTPS</td>
                    <td class="risk-medium">35</td>
                    <td>URL uses HTTP instead of HTTPS (non-localhost)</td>
                </tr>
                <tr class="ssl">
                    <td>HTTP on Localhost</td>
                    <td class="risk-low">5</td>
                    <td>HTTP used on localhost (acceptable for development)</td>
                </tr>
                <tr class="ssl">
                    <td>Invalid Port</td>
                    <td class="risk-low">10</td>
                    <td>Port number outside valid range (1-65535)</td>
                </tr>
                <tr class="ssl">
                    <td>Very Obsolete SSL</td>
                    <td class="risk-high">70</td>
                    <td>Uses insecure SSLv2 or SSLv3 protocols</td>
                </tr>
                <tr class="ssl">
                    <td>Obsolete TLS Version</td>
                    <td class="risk-medium">Variable (0-50)</td>
                    <td>Uses deprecated TLSv1 or TLSv1.1 (score adjusted by sensitivity multiplier)</td>
                </tr>
                <tr class="ssl">
                    <td>Outdated TLS Version</td>
                    <td class="risk-low">Variable (0-15)</td>
                    <td>Uses TLSv1.2 (still secure but newer versions preferred)</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expired</td>
                    <td class="risk-high">85</td>
                    <td>Certificate has already expired</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiring Imminently</td>
                    <td class="risk-medium">Variable (0-50)</td>
                    <td>Certificate expires in less than 7 days</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiring Soon (14d)</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Certificate expires in less than 14 days</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiring Soon (30d)</td>
                    <td class="risk-medium">Variable (0-25)</td>
                    <td>Certificate expires in less than 30 days (non-legitimate domains)</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Domain Mismatch</td>
                    <td class="risk-high">80</td>
                    <td>Certificate does not match domain</td>
                </tr>
                <tr class="ssl">
                    <td>Self-Signed Cert</td>
                    <td class="risk-high">75</td>
                    <td>Certificate is self-signed (non-localhost)</td>
                </tr>
                <tr class="ssl">
                    <td>Self-Signed (Dev)</td>
                    <td class="risk-low">15</td>
                    <td>Self-signed certificate on localhost (acceptable for development)</td>
                </tr>
                <tr class="ssl">
                    <td>Missing Issuer Info</td>
                    <td class="risk-medium">20</td>
                    <td>Certificate has no issuer common name</td>
                </tr>
                <tr class="ssl">
                    <td>Weak Signature Algorithm</td>
                    <td class="risk-medium">Variable (0-45)</td>
                    <td>Uses weak algorithm (MD2, MD5, SHA1)</td>
                </tr>
                <tr class="ssl">
                    <td>Weak Serial Number</td>
                    <td class="risk-medium">Variable (0-25)</td>
                    <td>Serial number too short (&lt;8 characters)</td>
                </tr>
                <tr class="ssl">
                    <td>New Certificate</td>
                    <td class="risk-medium">Variable (0-30)</td>
                    <td>Certificate issued less than 7 days ago</td>
                </tr>
                <tr class="ssl">
                    <td>Long Validity Period</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Certificate valid for more than 825 days (2.25 years)</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Verification Failed</td>
                    <td class="risk-high">70</td>
                    <td>Certificate verification failed</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Hostname Mismatch</td>
                    <td class="risk-high">75</td>
                    <td>Hostname does not match certificate</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Connection Failed</td>
                    <td class="risk-low">Variable (0-30)</td>
                    <td>Connection failed (network issue)</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Protocol Error</td>
                    <td class="risk-medium">Variable (0-40)</td>
                    <td>Protocol version mismatch</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Handshake Failed</td>
                    <td class="risk-medium">Variable (0-50)</td>
                    <td>TLS connection issue</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiry Parse Error</td>
                    <td class="risk-low">10</td>
                    <td>Could not parse certificate expiry date</td>
                </tr>
                <tr class="ssl">
                    <td>Very Obsolete SSL</td>
                    <td class="risk-high">70</td>
                    <td>Uses insecure SSLv2 or SSLv3 protocols</td>
                </tr>
                <tr class="ssl">
                    <td>Obsolete TLS Version</td>
                    <td class="risk-medium">Variable (0-50)</td>
                    <td>Uses deprecated TLSv1 or TLSv1.1</td>
                </tr>
                <tr class="ssl">
                    <td>Outdated TLS Version</td>
                    <td class="risk-low">Variable (0-15)</td>
                    <td>Uses older but still secure TLSv1.2</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiring Imminently</td>
                    <td class="risk-medium">Variable (0-50)</td>
                    <td>Certificate expires in less than 7 days</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiring Soon (14d)</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Certificate expires in less than 14 days</td>
                </tr>
                <tr class="ssl">
                    <td>SSL Expiring Soon (30d)</td>
                    <td class="risk-medium">Variable (0-25)</td>
                    <td>Certificate expires in less than 30 days (non-legitimate domains)</td>
                </tr>
                <tr class="ssl">
                    <td>Missing Issuer Info</td>
                    <td class="risk-medium">20</td>
                    <td>Certificate has no issuer common name</td>
                </tr>
                <tr class="ssl">
                    <td>Weak Signature Algorithm</td>
                    <td class="risk-medium">Variable (0-45)</td>
                    <td>Uses weak algorithm (MD2, MD5, SHA1)</td>
                </tr>
                <tr class="ssl">
                    <td>Weak Serial Number</td>
                    <td class="risk-medium">Variable (0-25)</td>
                    <td>Serial number too short (&lt;8 characters)</td>
                </tr>
                <tr class="ssl">
                    <td>New Certificate</td>
                    <td class="risk-medium">Variable (0-30)</td>
                    <td>Certificate issued less than 7 days ago</td>
                </tr>
                <tr class="ssl">
                    <td>Long Validity Period</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Certificate valid for more than 825 days (2.25 years)</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>Domain Analysis</h2>
            <p>Checks domain age and reputation to assess risk.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="other">
                    <td>Very Newly Registered</td>
                    <td class="risk-high">80</td>
                    <td>Domain registered less than 7 days ago</td>
                </tr>
                <tr class="other">
                    <td>Newly Registered Domain</td>
                    <td class="risk-high">60</td>
                    <td>Domain registered 7-30 days ago</td>
                </tr>
                <tr class="other">
                    <td>Recently Registered</td>
                    <td class="risk-medium">40</td>
                    <td>Domain registered 30-90 days ago</td>
                </tr>
                <tr class="other">
                    <td>Young Domain</td>
                    <td class="risk-medium">20</td>
                    <td>Domain registered 90-180 days ago</td>
                </tr>
                <tr class="other">
                    <td>Moderately Young Domain</td>
                    <td class="risk-low">10</td>
                    <td>Domain registered 180-365 days ago</td>
                </tr>
                <tr class="other">
                    <td>Expiring Very Soon</td>
                    <td class="risk-high">45</td>
                    <td>Domain expires in less than 14 days</td>
                </tr>
                <tr class="other">
                    <td>Expiring Soon</td>
                    <td class="risk-medium">25</td>
                    <td>Domain expires in less than 30 days</td>
                </tr>
                <tr class="other">
                    <td>WHOIS Privacy</td>
                    <td class="risk-low">5</td>
                    <td>WHOIS data is private/protected</td>
                </tr>
                <tr class="other">
                    <td>WHOIS Hidden/Fail</td>
                    <td class="risk-medium">30</td>
                    <td>Could not retrieve WHOIS data</td>
                </tr>
                <tr class="other">
                    <td>No MX Records</td>
                    <td class="risk-low">15</td>
                    <td>Domain cannot receive email</td>
                </tr>
                <tr class="other">
                    <td>Very High IP Count</td>
                    <td class="risk-high">40</td>
                    <td>Resolves to 20+ IPs (possible Fast-Flux)</td>
                </tr>
                <tr class="other">
                    <td>High IP Count</td>
                    <td class="risk-medium">20</td>
                    <td>Resolves to 10+ IPs</td>
                </tr>
                <tr class="other">
                    <td>Very Short DNS TTL</td>
                    <td class="risk-high">60</td>
                    <td>DNS TTL under 30 seconds (Fast-Flux indicator)</td>
                </tr>
                <tr class="other">
                    <td>Short DNS TTL</td>
                    <td class="risk-medium">35</td>
                    <td>DNS TTL under 60 seconds (possible Fast-Flux)</td>
                </tr>
                <tr class="other">
                    <td>DNS Resolution Failed</td>
                    <td class="risk-medium">30</td>
                    <td>Could not resolve domain to IP</td>
                </tr>
            </table>
        </div>
        
        <div class="section">
            <h2>Malicious File Detection</h2>
            <p>Detection of known malicious files, test files (like EICAR), and suspicious file types.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="other">
                    <td>EICAR Test File</td>
                    <td class="risk-high">95</td>
                    <td>Detects EICAR antivirus test file (standard test file for antivirus systems)</td>
                </tr>
                <tr class="other">
                    <td>Malicious Pattern Match</td>
                    <td class="risk-high">80</td>
                    <td>URL matches malicious pattern (e.g., eicar.*\.com)</td>
                </tr>
                <tr class="other">
                    <td>Suspicious Download Path</td>
                    <td class="risk-medium">40</td>
                    <td>URL contains suspicious download path (e.g., /download/eicar.com.txt)</td>
                </tr>
                <tr class="other">
                    <td>Suspicious File Extension</td>
                    <td class="risk-high">75</td>
                    <td>Detects potentially dangerous file extensions (exe, scr, bat, cmd, vbs, etc.)</td>
                </tr>
                <tr class="other">
                    <td>Suspicious Keyword</td>
                    <td class="risk-medium">35</td>
                    <td>URL contains suspicious keywords in path or query</td>
                </tr>
            </table>
        </div>
        
        <div class="section">
            <h2>Advanced Features Analysis</h2>
            <p>Detailed analysis of URL structure, parameters, and advanced indicators.</p>
            <table>
                <tr>
                    <th>Risk Parameter</th>
                    <th>Score</th>
                    <th>Description</th>
                </tr>
                <tr class="other">
                    <td>Excessive Path Depth</td>
                    <td class="risk-medium">40</td>
                    <td>URL has more than 7 path levels (typical: 2-5)</td>
                </tr>
                <tr class="other">
                    <td>Excessive Parameters</td>
                    <td class="risk-medium">35</td>
                    <td>More than 10 query parameters (complexity)</td>
                </tr>
                <tr class="other">
                    <td>Suspicious Parameter Names</td>
                    <td class="risk-medium">50</td>
                    <td>Parameters like redirect, url, next, goto, etc.</td>
                </tr>
                <tr class="other">
                    <td>URL in Parameter</td>
                    <td class="risk-medium">35</td>
                    <td>Parameter contains URL (open redirect risk)</td>
                </tr>
                <tr class="other">
                    <td>Script in Parameter</td>
                    <td class="risk-high">60</td>
                    <td>Parameter contains script indicator</td>
                </tr>
                <tr class="other">
                    <td>Large Fragment</td>
                    <td class="risk-low">25</td>
                    <td>Fragment identifier longer than 100 characters</td>
                </tr>
                <tr class="other">
                    <td>Suspicious Fragment</td>
                    <td class="risk-high">55</td>
                    <td>Fragment contains suspicious patterns</td>
                </tr>
                <tr class="other">
                    <td>Extension Spoofing</td>
                    <td class="risk-high">65</td>
                    <td>File extension spoofing (e.g., .pdf.exe)</td>
                </tr>
                <tr class="other">
                    <td>Directory Traversal Pattern</td>
                    <td class="risk-high">70</td>
                    <td>Contains path traversal patterns (../, ..\)</td>
                </tr>
                <tr class="other">
                    <td>SQL Injection Pattern</td>
                    <td class="risk-high">75</td>
                    <td>Detects potential SQL injection patterns</td>
                </tr>
                <tr class="other">
                    <td>Potential SQL Pattern</td>
                    <td class="risk-medium">40</td>
                    <td>Contains potential SQL-related patterns</td>
                </tr>
                <tr class="other">
                    <td>Command Injection Pattern</td>
                    <td class="risk-high">70</td>
                    <td>Detects potential command injection patterns</td>
                </tr>
                <tr class="other">
                    <td>Shell Metacharacters</td>
                    <td class="risk-medium">35</td>
                    <td>Contains shell metacharacters</td>
                </tr>
                <tr class="other">
                    <td>Numeric Subdomain</td>
                    <td class="risk-medium">30</td>
                    <td>Subdomain consists of numbers only</td>
                </tr>
                <tr class="other">
                    <td>Multi-Category Risk Correlation</td>
                    <td class="risk-high">60</td>
                    <td>Risks detected in 4+ different categories</td>
                </tr>
                <tr class="other">
                    <td>High Anomaly Score</td>
                    <td class="risk-high">50</td>
                    <td>Accumulated risk exceeding 100 points</td>
                </tr>
                <tr class="other">
                    <td>High {char} Character Frequency</td>
                    <td class="risk-medium">Variable (0-40)</td>
                    <td>Unusual frequency of specific characters</td>
                </tr>
                <tr class="other">
                    <td>Very High Domain Entropy</td>
                    <td class="risk-medium">Variable (0-50)</td>
                    <td>Domain has very high randomness</td>
                </tr>
                <tr class="other">
                    <td>High Digit Ratio</td>
                    <td class="risk-medium">Variable (0-45)</td>
                    <td>High percentage of digits in URL</td>
                </tr>
                <tr class="other">
                    <td>Long Digit Sequences</td>
                    <td class="risk-medium">Variable (0-35)</td>
                    <td>Sequences of 4+ consecutive digits</td>
                </tr>
                <tr class="other">
                    <td>Multiple Encoding Layers</td>
                    <td class="risk-medium">Variable (0-55)</td>
                    <td>Multiple layers of encoding detected</td>
                </tr>
                <tr class="other">
                    <td>Abnormal Linguistic Pattern</td>
                    <td class="risk-medium">Variable</td>
                    <td>Unusual linguistic patterns detected</td>
                </tr>
                <tr class="other">
                    <td>Deep Subdomain Nesting</td>
                    <td class="risk-medium">Variable (0-45)</td>
                    <td>Deep nesting of subdomains detected</td>
                </tr>
                <tr class="other">
                    <td>Unusually Long Subdomain</td>
                    <td class="risk-medium">Variable (0-40)</td>
                    <td>Subdomain exceeds normal length</td>
                </tr>
                <tr class="other">
                    <td>Multiple Hyphens in Domain</td>
                    <td class="risk-medium">Variable (0-40)</td>
                    <td>Multiple hyphens in domain name</td>
                </tr>
                <tr class="other">
                    <td>Digit Sequence in Domain</td>
                    <td class="risk-medium">35</td>
                    <td>Digit sequences detected in domain</td>
                </tr>
                <tr class="other">
                    <td>High-Abuse ccTLD</td>
                    <td class="risk-medium">45</td>
                    <td>Country code TLD with high abuse rate</td>
                </tr>
            </table>
        </div>
        
        <div class="section">
            <h2>Module Risk Weights</h2>
            <p>Weights applied to each analysis module when calculating the final risk score.</p>
            <table>
                <tr>
                    <th>Analysis Module</th>
                    <th>Weight</th>
                    <th>Description</th>
                </tr>
                <tr class="other">
                    <td>Lexical Analysis</td>
                    <td>0.20</td>
                    <td>URL structure and obfuscation analysis</td>
                </tr>
                <tr class="other">
                    <td>Domain Analysis</td>
                    <td>0.30</td>
                    <td>Domain reputation and registration data</td>
                </tr>
                <tr class="other">
                    <td>SSL Analysis</td>
                    <td>0.25</td>
                    <td>Certificate and protocol validation</td>
                </tr>
                <tr class="other">
                    <td>Content Analysis</td>
                    <td>0.15</td>
                    <td>Page content and structure analysis</td>
                </tr>
                <tr class="other">
                    <td>AI Analysis</td>
                    <td>0.10</td>
                    <td>Machine learning pattern detection</td>
                </tr>
                <tr class="other">
                    <td>Advanced Lexical</td>
                    <td>0.08</td>
                    <td>Enhanced lexical analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced Structural</td>
                    <td>0.07</td>
                    <td>Enhanced URL structure analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced Domain</td>
                    <td>0.06</td>
                    <td>Enhanced domain analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced Content</td>
                    <td>0.05</td>
                    <td>Enhanced content analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced JavaScript</td>
                    <td>0.10</td>
                    <td>JavaScript code analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced Heuristic</td>
                    <td>0.08</td>
                    <td>NLP and heuristic analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced Behavioral</td>
                    <td>0.12</td>
                    <td>Behavioral pattern analysis</td>
                </tr>
                <tr class="other">
                    <td>Advanced Certificate</td>
                    <td>0.09</td>
                    <td>Enhanced certificate analysis</td>
                </tr>
                <tr class="other">
                    <td>Malicious File Detection</td>
                    <td>0.40</td>
                    <td>Detection of known malicious files, EICAR test files, and suspicious patterns</td>
                </tr>
            </table>
        </div>

        <div class="section">
            <h2>Sensitivity Multiplier</h2>
            <p>The system uses a sensitivity multiplier to adjust risk scores based on domain trustworthiness:</p>
            <ul>
                <li><strong>Trusted Domains:</strong> 0.5 multiplier (reduced sensitivity)</li>
                <li><strong>Known Legitimate Patterns:</strong> 0.5 multiplier (reduced sensitivity)</li>
                <li><strong>All Others:</strong> 1.0 multiplier (full sensitivity)</li>
            </ul>
            <p>This prevents false positives on known legitimate sites while maintaining security for unknown domains.</p>
        </div>

        <div class="section">
            <h2>Special Handling</h2>
            <p>Certain conditions trigger immediate classification regardless of accumulated score:</p>
            <ul>
                <li><strong>Early Exit on Critical Layer 1 Risks:</strong> If Layer 1 score  80, analysis stops early</li>
                <li><strong>Trusted Domain Whitelist:</strong> Trusted domains automatically classified as Safe (score 0)</li>
                <li><strong>Maximum Score Cap:</strong> Final score is capped at 100</li>
                <li><strong>High-Confidence Threat Override:</strong> EICAR test files and other high-confidence threats override other scores</li>
            </ul>
        </div>
    </div>
</body>
</html>